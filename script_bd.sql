--
-- Create model Categoria
--
CREATE TABLE "CORE_CATEGORIA" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "NOMBRE_CATEGORIA" NVARCHAR2(30) NULL, "DESCRIPCION" NCLOB NULL);
--
-- Create model Direccion
--
CREATE TABLE "CORE_DIRECCION" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "CALLE" NVARCHAR2(60) NULL, "NUMERO" NUMBER(11) NOT NULL, "DEPTO" NVARCHAR2(30) NULL);
--
-- Create model Rol
--
CREATE TABLE "CORE_ROL" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "NOMBRE_ROL" NVARCHAR2(20) NULL);
--
-- Create model Usuario
--
CREATE TABLE "CORE_USUARIO" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "PASSWORD" NVARCHAR2(128) NULL, "LAST_LOGIN" TIMESTAMP NULL, "IS_SUPERUSER" NUMBER(1) NOT NULL CHECK ("IS_SUPERUSER" IN (0,1)), "USERNAME" NVARCHAR2(150) NULL UNIQUE, "FIRST_NAME" NVARCHAR2(150) NULL, "LAST_NAME" NVARCHAR2(150) NULL, "IS_STAFF" NUMBER(1) NOT NULL CHECK ("IS_STAFF" IN (0,1)), "IS_ACTIVE" NUMBER(1) NOT NULL CHECK ("IS_ACTIVE" IN (0,1)), "DATE_JOINED" TIMESTAMP NOT NULL, "NOMBRE" NVARCHAR2(50) NULL, "APELLIDO" NVARCHAR2(50) NULL, "EMAIL" NVARCHAR2(254) NULL UNIQUE, "FECHA_NACIMIENTO" DATE NULL, "FECHA_REGISTRO" TIMESTAMP NOT NULL, "DIRECCION_ID" NUMBER(19) NULL, "ROL_ID" NUMBER(19) NULL);
CREATE TABLE "CORE_USUARIO_GROUPS" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "USUARIO_ID" NUMBER(19) NOT NULL, "GROUP_ID" NUMBER(11) NOT NULL);
CREATE TABLE "CORE_USUARIO_USER_PERMISSIONS" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "USUARIO_ID" NUMBER(19) NOT NULL, "PERMISSION_ID" NUMBER(11) NOT NULL);
--
-- Create model Carrito
--
CREATE TABLE "CORE_CARRITO" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "FECHA_CREACION" DATE NOT NULL, "ESTADO" NVARCHAR2(1) NULL, "USUARIO_ID" NUMBER(19) NOT NULL);
--
-- Create model Compra
--
CREATE TABLE "CORE_COMPRA" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "FECHA_COMPRA" DATE NOT NULL, "TOTAL" NUMBER(10, 2) NOT NULL, "METODO_PAGO" NVARCHAR2(20) NULL, "CARRITO_ID" NUMBER(19) NOT NULL, "USUARIO_ID" NUMBER(19) NOT NULL);
--
-- Create model Producto
--
CREATE TABLE "CORE_PRODUCTO" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "NOMBRE" NVARCHAR2(20) NULL, "DESCRIPCION" NVARCHAR2(100) NULL, "PRECIO" NUMBER(10, 2) NOT NULL, "STOCK" NUMBER(11) NOT NULL, "IMAGEN" NVARCHAR2(100) NULL, "CATEGORIA_ID" NUMBER(19) NOT NULL);
--
-- Create model CarritoProducto
--
CREATE TABLE "CORE_CARRITOPRODUCTO" ("ID" NUMBER(19) GENERATED BY DEFAULT ON NULL AS IDENTITY NOT NULL PRIMARY KEY, "CANTIDAD" NUMBER(11) NOT NULL CHECK ("CANTIDAD" >= 0), "CARRITO_ID" NUMBER(19) NOT NULL, "PRODUCTO_ID" NUMBER(19) NOT NULL);
ALTER TABLE "CORE_USUARIO" ADD CONSTRAINT "CORE_USUA_DIRECCION_BE026957_F" FOREIGN KEY ("DIRECCION_ID") REFERENCES "CORE_DIRECCION" ("ID") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "CORE_USUARIO" ADD CONSTRAINT "CORE_USUA_ROL_ID_045D6E32_F" FOREIGN KEY ("ROL_ID") REFERENCES "CORE_ROL" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_USUAR_DIRECCION__BE026957" ON "CORE_USUARIO" ("DIRECCION_ID");
CREATE INDEX "CORE_USUARIO_ROL_ID_045D6E32" ON "CORE_USUARIO" ("ROL_ID");
ALTER TABLE "CORE_USUARIO_GROUPS" ADD CONSTRAINT "CORE_USUA_USUARIO_I_BDE3C750_U" UNIQUE ("USUARIO_ID", "GROUP_ID");
ALTER TABLE "CORE_USUARIO_GROUPS" ADD CONSTRAINT "CORE_USUA_USUARIO_I_97385234_F" FOREIGN KEY ("USUARIO_ID") REFERENCES "CORE_USUARIO" ("ID") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "CORE_USUARIO_GROUPS" ADD CONSTRAINT "CORE_USUA_GROUP_ID_55312A9A_F" FOREIGN KEY ("GROUP_ID") REFERENCES "AUTH_GROUP" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_USUAR_USUARIO_ID_97385234" ON "CORE_USUARIO_GROUPS" ("USUARIO_ID");
CREATE INDEX "CORE_USUAR_GROUP_ID_55312A9A" ON "CORE_USUARIO_GROUPS" ("GROUP_ID");
ALTER TABLE "CORE_USUARIO_USER_PERMISSIONS" ADD CONSTRAINT "CORE_USUA_USUARIO_I_7A048D24_U" UNIQUE ("USUARIO_ID", "PERMISSION_ID");
ALTER TABLE "CORE_USUARIO_USER_PERMISSIONS" ADD CONSTRAINT "CORE_USUA_USUARIO_I_CE4108A7_F" FOREIGN KEY ("USUARIO_ID") REFERENCES "CORE_USUARIO" ("ID") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "CORE_USUARIO_USER_PERMISSIONS" ADD CONSTRAINT "CORE_USUA_PERMISSIO_7F881653_F" FOREIGN KEY ("PERMISSION_ID") REFERENCES "AUTH_PERMISSION" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_USUAR_USUARIO_ID_CE4108A7" ON "CORE_USUARIO_USER_PERMISSIONS" ("USUARIO_ID");
CREATE INDEX "CORE_USUAR_PERMISSION_7F881653" ON "CORE_USUARIO_USER_PERMISSIONS" ("PERMISSION_ID");
ALTER TABLE "CORE_CARRITO" ADD CONSTRAINT "CORE_CARR_USUARIO_I_9EAFCB26_F" FOREIGN KEY ("USUARIO_ID") REFERENCES "CORE_USUARIO" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_CARRI_USUARIO_ID_9EAFCB26" ON "CORE_CARRITO" ("USUARIO_ID");
ALTER TABLE "CORE_COMPRA" ADD CONSTRAINT "CORE_COMP_CARRITO_I_852B20E6_F" FOREIGN KEY ("CARRITO_ID") REFERENCES "CORE_CARRITO" ("ID") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "CORE_COMPRA" ADD CONSTRAINT "CORE_COMP_USUARIO_I_DDC04A7F_F" FOREIGN KEY ("USUARIO_ID") REFERENCES "CORE_USUARIO" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_COMPR_CARRITO_ID_852B20E6" ON "CORE_COMPRA" ("CARRITO_ID");
CREATE INDEX "CORE_COMPR_USUARIO_ID_DDC04A7F" ON "CORE_COMPRA" ("USUARIO_ID");
ALTER TABLE "CORE_PRODUCTO" ADD CONSTRAINT "CORE_PROD_CATEGORIA_65B2D0AF_F" FOREIGN KEY ("CATEGORIA_ID") REFERENCES "CORE_CATEGORIA" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_PRODU_CATEGORIA__65B2D0AF" ON "CORE_PRODUCTO" ("CATEGORIA_ID");
ALTER TABLE "CORE_CARRITOPRODUCTO" ADD CONSTRAINT "CORE_CARR_CARRITO_I_826535DA_F" FOREIGN KEY ("CARRITO_ID") REFERENCES "CORE_CARRITO" ("ID") DEFERRABLE INITIALLY DEFERRED;
ALTER TABLE "CORE_CARRITOPRODUCTO" ADD CONSTRAINT "CORE_CARR_PRODUCTO__A7FAE35A_F" FOREIGN KEY ("PRODUCTO_ID") REFERENCES "CORE_PRODUCTO" ("ID") DEFERRABLE INITIALLY DEFERRED;
CREATE INDEX "CORE_CARRI_CARRITO_ID_826535DA" ON "CORE_CARRITOPRODUCTO" ("CARRITO_ID");
CREATE INDEX "CORE_CARRI_PRODUCTO_I_A7FAE35A" ON "CORE_CARRITOPRODUCTO" ("PRODUCTO_ID");

INSERT INTO core_categoria (nombre_categoria, descripcion) VALUES ('Sega', NULL);
INSERT INTO core_categoria (nombre_categoria, descripcion) VALUES ('Play Station', NULL);
INSERT INTO core_categoria (nombre_categoria, descripcion) VALUES ('Nintendo', NULL);
INSERT INTO core_categoria (nombre_categoria, descripcion) VALUES ('Atari', NULL);
INSERT INTO core_categoria (nombre_categoria, descripcion) VALUES ('Dreamcast', NULL);

COMMIT;
